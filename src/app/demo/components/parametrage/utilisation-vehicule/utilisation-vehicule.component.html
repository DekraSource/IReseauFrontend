<!-- utilisation-vehicule.component.html -->
<div class="card">
  <p-toast></p-toast>

  <p-toolbar>
    <ng-template pTemplate="left">
      <span class="text-xl font-bold">Utilisation véhicules</span>
    </ng-template>

    <ng-template pTemplate="right">
    </ng-template>
  </p-toolbar>

  <p-table [value]="utilisationVehicules" [rowStyleClass]="rowStyleFunc" [paginator]="true" [rows]="10"
    [rowsPerPageOptions]="[5,10,25,50]" [showCurrentPageReport]="true"
    currentPageReportTemplate="Affichage de {first} à {last} sur {totalRecords} entrées"
    styleClass="p-datatable-gridlines p-datatable-sm p-datatable-striped p-datatable-hoverable-rows">
    <ng-template pTemplate="header">
      <tr>
        <th pSortableColumn="libelle"><div class="flex align-items-center gap-2"><p-sortIcon field="libelle"></p-sortIcon>Libelle<p-columnFilter type="text" field="libelle" display="menu" class="ml-auto"></p-columnFilter></div></th>
        <th pSortableColumn="eosLibelle"><div class="flex align-items-center gap-2"><p-sortIcon field="eosLibelle"></p-sortIcon>Eos Libelle<p-columnFilter type="text" field="eosLibelle" display="menu" class="ml-auto"></p-columnFilter></div></th>
        <th pSortableColumn="periodicite"><div class="flex align-items-center gap-2"><p-sortIcon field="periodicite"></p-sortIcon>Périodicité<p-columnFilter type="text" field="periodicite" display="menu" class="ml-auto"></p-columnFilter></div></th>
        <th>{{utilisationVehicules.length}}</th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-item>
      <tr>
        <td>{{item.libelle}}</td>
        <td>{{item.eosLibelle}}</td>
        <td>{{item.periodicite}}</td>
        <td>
          <div class="flex justify-content-end gap-2">
                <button pButton type="button" icon="pi pi-pencil" class="p-button-outlined p-button-sm"
              (click)="edit(item)" pTooltip="Modifier" tooltipPosition="top"></button>          
          </div>
        </td>
      </tr>
    </ng-template>
  </p-table>
</div>

<p-dialog header="Formulaire" [(visible)]="visible" [dismissableMask]="true" [modal]="true" [style]="{width: '40vw'}">
  <form class="p-fluid p-mt-2 p-mb-2">
    <!-- Libellé actuel -->
    <div class="p-field">
      <label for="libelle">Libellé actuel</label>
      <input pInputText id="libelle" [(ngModel)]="model.libelle" name="libelle" disabled class="w-full" />
    </div>

    <!-- Nouveau libellé -->
    <div class="p-field mt-4">
      <label for="eosLibelle">Nouveau libellé</label>
      <p-dropdown
        id="eosLibelle"
        [options]="filterUtilisationVehicules"
        [(ngModel)]="model.eosLibelle"
        name="eosLibelle"
        optionLabel="eosLibelle"
        optionValue="eosLibelle"
        [appendTo]="'body'"
        class="w-full"
        [filter]="true"
        placeholder="Sélectionner un libellé">
        <ng-template pTemplate="item" let-item>
          {{ item.eosLibelle }}
        </ng-template>
      </p-dropdown>
    </div>
  </form>

  <!-- Footer -->
  <ng-template pTemplate="footer">
    <div class="flex justify-content-end gap-3">
      <p-button icon="pi pi-times" label="Annuler" (click)="cancel()" styleClass="p-button-text"></p-button>
      <p-button icon="pi pi-check" label="Enregistrer" (click)="submit()" [disabled]="!model.eosLibelle"></p-button>
    </div>
  </ng-template>
</p-dialog>

